<style scoped>
    .content{
        padding:20px;
    }
    .textarea{
        width:100%;
        height:300px;
        background:#000;
        padding:20px;
        border:solid 1px #000;
        color:#fff;
    }
    .terminal{
        padding:20px;
    }
</style>
<div class="content" id="home" v-cloak>
    
    <div>textarea框效果</div>
    <div id="result" style="display:none;"><%=data.result %></div>
    <textarea class="textarea mt10" v-model="textarea"></textarea>
    <el-button class="mt20" @click="update" type="primary">修改</el-button>

    <div class="mb20"></div>
    <div>xterm框效果</div>
    <div class="mt10" id="terminal"></div>

</div>
<script>
new Vue({
    el: '#home',
    data: function () {
        return {
            name:'zane',
            textarea: '',
        }
    },
    filters: {
    },
    mounted() {
        this.textarea = $('#result').text()

        var term = new Terminal();
        term.open(document.getElementById('terminal'));
        
        function runFakeTerminal() {
            if (term._initialized) {
                return;
            }

            term._initialized = true;

            term.prompt = () => {
                term.write('\r\n$ ');
            };

            term.prompt();

            term.on('key', function (key, ev) {
                const printable = !ev.altKey && !ev.altGraphKey && !ev.ctrlKey && !ev.metaKey;

                if (ev.keyCode === 13) {
                    term.prompt();
                } else if (ev.keyCode === 8) {
                    if (term._core.buffer.x > 2) {
                        term.write('\b \b');
                    }
                } else if (printable) {
                    term.write(key);
                }
            });

            term.on('paste', function (data) {
                term.write(data);
            });
        }
        runFakeTerminal();
    },
    methods: {
        update(){
            util.ajax({
                url:`${config.baseApi}api/v1/home/set`,
                data:{
                    text: this.textarea,
                },
                success:data=>{

                }
            })
        },
    }    
})
</script>